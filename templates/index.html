<!DOCTYPE html>
<html>
<head>
  <title>Teoskatalogi</title>
</head>
<body>
    <!-- Ylävalikko -->
    <h1> <a href = "/"> Teoskatalogi </a> </h1>
    <ul>
        {% if session.user_id %}
            <li> 
                <a href="/kayttaja/{{session.user_id}}">{{session.user_name}}</a>
            </li>
        {% endif %}
        <li><a href="/haku"> Haku </a></li>
        <li><a href="/kokoelmat"> Kokoelmat </a></li>
        {% if session.user_id %}
            <li><a href="/kirjaudu_ulos"> Kirjaudu ulos </a></li>
        {% else %}
            <li><a href="/kirjaudu"> Kirjaudu sisään </a></li>
        {% endif %}
    </ul>
    <hr />

    <!-- Teokset -->
    <h2> Teokset </h2>
    
    <!-- Lisää uusi teos -->
    {% if session.user_id %}
        <form action="/luo_teos" method="post">
            <input type="hidden" name="csrf_token" value={{session.csrf_token}} />
            <ul style="list-style-type: none">
                <li>Lisää uusi teos:</li>
                <li>Nimi: <input type="text" name="work_title_input" maxlength="50"/></li>
                <li>Vuosi: <input type="text" value="2025"</li>
                <li>Tekniikka: <select name="medium_input"></li>
                <option value="other"> (valitse) </option>
                    {% for cl in all_classes["tekniikka"] %}
                        <option value="{{cl}}"> {{cl}} </option>
                    {% endfor %}
                </select>
                <li><input type="submit" value="Tallenna" /></li>
            </ul>
        </form>
    {% endif %}
        
    <!-- Teosluettelo -->    
    {% for w in works %}
        <ul style="list-style-type: none">
            <li style="text-transform: capitalize">
                <i>{{ w["title"] }}.</i>
                {{w["user_name"]}} 2025.
                {% for c in work_classes[w["id"]] %}
                    {{ c["title"] }}: {{c["value"] }}.
                {% endfor %}
            </li>
            {% if collections[w["id"]] %}
            <li>
                Sisältyy kokoelmiin: 
                {% for c in collections[w["id"]] %}
                    {{ c["title"] }}.
                {% endfor %}
            </li>
            {% endif %}
            <li>
                {% if session.user_id == w["user_id"] %}
                    <form action="/poista_teos/{{w["id"]}}" method="post" style="display:inline"> 
                        <input type="hidden" name="csrf_token" value={{session.csrf_token}} />
                        <input type="submit" value="Poista" />
                    </form>
                    <form action="/muokkaa_teosta/{{w["id"]}}" method="get" style="display:inline"> 
                        <input type="hidden" name="csrf_token" value={{session.csrf_token}} />
                        <input type="submit" value="Muokkaa" />
                    </form>
                {% endif %}
            </li>
        </ul>
    {% endfor %}
</body>
</html>

